<!DOCTYPE html>
<html>
<head>
	<title></title>
	<link rel="stylesheet" href="static/css/bootstrap.min.css">
	<link rel="stylesheet" href="static/css/main.css">
	<script src="static/js/jquery-1.10.2.js"></script>
	<script src="static/js/topBar.js"></script>
	<script type="text/javascript">
	$(document).ready(function() {
		setTopBar(); //
	});

	var user;
	var jsonData = {
			"serverCode" : "userInfo"
			};
			$.ajax({
			url : "./webAction",
			type : 'POST',
			dataType : 'text',
			async: false,
			data : jsonData,
			success:function(data) {
				var jData = JSON.parse(data);
				var serverMsg = jData.serverMsg;
				if (serverMsg=="success"){
					user=jData.data[0];
				}else{
					window.location.href="login.html"
				}
			}
			});
	</script>
</head>
<body>


<div class="container"> 
	 <div class="header clearfix" id="topBar">
      </div>

 	<div class="row">
 		<div class="col-md-3">
 			
 			<div class="panel panel-default">
			  <div class="panel-body" id="userInfo-left">
			 <!--  <img src="img/1.jpg" alt="..." class="img-circle" width="50" height="50">
 				<span>甩甩</span> -->
 			<br />
 			<br />
			    <a class="btn btn-default" href="#" role="button">个人设置</a>
				<br />
				<br />
			    <ul style="list-style: none;">
			    	<li><a href="">观看记录</a></li>
			    	<li><a href="">我的收藏</a></li>
			    	<li><a href="">上传视频</a></li>
			    	<li><a href="">悬赏视频</a></li>
			    </ul>
			  </div>
			</div>
 		</div>


 		<div class="col-md-9">

 		<div class="usersetting">
 		<h4>个 人信息</h4>
 		<div class="row">
 			<div class="col-md-3">
	 			<div class="thumbnail" >
			      <img id="rightUserImg" src="img/1.jpg" alt="..." >
			      <div class="caption">
			        <p><a href="#" class="btn btn-primary" role="button">修改头像</a> </p>
			      </div>
			    </div>
	 		</div>
	 		<div class="col-md-9">
	 		</div>
 		</div>

 		<div class="row">
 			<table class="table table-bordered">
			  <tbody>
			  	<tr>
			  		<td>昵称</td>
			  		<td>甩甩</td>
			  		<td>修改</td>
			  	</tr>
			  	<tr>
			  		<td>性别</td>
			  		<td>男</td>
			  		<td>修改</td>
			  	</tr>
			  		<tr>
			  		<td>qq</td>
			  		<td>12345</td>
			  		<td>修改</td>
			  	</tr>
			  </tbody>
			</table>
 		</div>
	 		
 		</div>

			<div class="viewlist" >
					<h4>观看记录</h4>
				 	<div class="row" id="myViewlist">
					</div>
			</div>

			<div class="myshow">
					<h4>我的收藏</h4>
				 	<div class="row" id="myCollectVideoList">
					</div>
			</div>

			<div class="upload">
				<h4>上传视频</h4>
				<hr ／>
				<form class="form-horizontal">
				  <div class="form-group">
				    <label for="inputEmail3" class="col-sm-3 control-label">视频名称</label>
				    <div class="col-sm-9">
				      <input type="text" class="form-control" id="videoName">
				    </div>
				  </div>
				  <div class="form-group">
				    <label for="inputPassword3" class="col-sm-3 control-label">视频描述</label>
				    <div class="col-sm-9">
				      <input type="text" class="form-control" id="videoDesc">
				    </div>
				  </div>
				  <div class="form-group">
				    <label for="inputPassword3" class="col-sm-3 control-label">选择分类</label>
				    <div class="col-sm-9">
				      <input type="text" class="form-control" id="videoType">
				    </div>
				  </div>
				  <div class="form-group">
				    <label for="exampleInputFile"  class="col-sm-3 control-label">上传封面图片</label>
				     <div class="col-sm-9">
				       <input type="file" id="exampleInputFile">
				    </div>
				   
				  </div>
				 <div class="form-group">
				    <label for="exampleInputFile"  class="col-sm-3 control-label">上传视频</label>
				     <div class="col-sm-9">
				       <input type="file" id="exampleInputFile">
				    </div>
				  </div>
				   <input type="submit" value="保存" class="btn" id="saveVideo" >
				</form>
			</div>

			<div class="dashang">
				<h4>悬赏视频</h4>
				<hr>
				<form class="form-horizontal">
				  <div class="form-group">
				    <label for="inputEmail3" class="col-sm-3 control-label">发布内容</label>
				    <div class="col-sm-9">
				      <input type="text" class="form-control" id="xuanshang">
				    </div>
				  </div>
				  <input type="submit" value="发布" class="btn" id="pushXs">
				</form>
			</div>
 		</div>
 	</div>
</div>


<script>
	$(function(){

		console.log("resuser: "+JSON.stringify(user));
		userInfo();
		viewlist();
		mycollectVideo();


		$("#saveVideo").click(function(){
			console.log("onclick");
			var videoname=$("#videoName").val();
			var videoDesc=$("#videoDesc").val();
			var videoType=$('#videoType').val();

			console.log("videoname:"+videoname);
			console.log("videoDesc:"+videoDesc);
			console.log("videoType:"+videoType);

			var jsonData = {
			"serverCode" : "saveVideoUpload",
			"videoName" : videoname,
			"videoDesc" :videoDesc,
			"pic" :"userPicPath/user_head.png",
			"address" : "http://7u2qky.com1.z0.glb.clouddn.com/beijing.mp4",
			"videoTypeId" : videoType
			};

			 $.ajax({
				url : "./webAction",
				type : 'POST',
				dataType : 'text',
				data : jsonData,
				success:function(data) {
					var jData = JSON.parse(data);
					var serverMsg = jData.serverMsg;
					alert(serverMsg=="success"?"保存成功":"失败");
				}
			});

		});

		$('#pushXs').click(function(){
			var str=$('#xuanshang').val();
			var jsonData = {
				"serverCode" : "rewardAdd",
				"content" : str, 
				"money" : "1.0"
			}
			 $.ajax({
				url : "./webAction",
				type : 'POST',
				dataType : 'text',
				data : jsonData,
				success:function(data) {
					var jData = JSON.parse(data);
					var serverMsg = jData.serverMsg;
					alert(serverMsg=="success"?"发布成功":"失败");
				}
			});
		});


	});
	
	function userInfo(){
		var str='<img src="'+user.pic+'" alt="..." class="img-circle" width="50" height="50">'
 			str+='<span>'+user.userName+'</span>'
		$("#userInfo-left").append(str);
		$("#rightUserImg").attr("src",user.pic);

	}


	

	function viewlist(){
		var jsonData = {
			"serverCode" : "myViewVideoList"
			};

		    $.ajax({
				url : "./webAction",
				type : 'POST',
				dataType : 'text',
				data : jsonData,
				success:function(data) {
					var jData = JSON.parse(data);
					var serverMsg = jData.serverMsg;
					if (serverMsg=="success"){
						list(jData);
					}else{
						alert(serverMsg);
					}
					
				}
			});

			function list(res){
				for (var i = res.data.length - 1; i >= 0; i--) {
					var str='<div class="col-xs-6 col-md-3">'
					 	str+='<a href="#" class="thumbnail">'
					    str+='<img src="'+res.data[i].videoPic+'" alt="...">'
					    str+='</a></div>'
					    $("#myViewlist").append(str); 
				}
			}		
	}


	function mycollectVideo(){
		var jsonData = {
			"serverCode" : "myCollectVideoList"
			};

		    $.ajax({
				url : "./webAction",
				type : 'POST',
				dataType : 'text',
				data : jsonData,
				success:function(data) {
					var jData = JSON.parse(data);
					var serverMsg = jData.serverMsg;
					if (serverMsg=="success"){
						list(jData);
					}else{
						alert(serverMsg);
					}
					
				}
			});

			function list(res){
				for (var i = res.data.length - 1; i >= 0; i--) {
					var str='<div class="col-xs-6 col-md-3">'
					 	str+='<a href="#" class="thumbnail">'
					    str+='<img src="'+res.data[i].videoPic+'" alt="...">'
					    str+='</a></div>'
					    $("#myCollectVideoList").append(str); 
				}
			}		
	}


	
</script>
</body>
</html>